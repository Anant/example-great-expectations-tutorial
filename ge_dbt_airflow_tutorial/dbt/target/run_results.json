{"results": [{"node": {"raw_sql": "select \n\tnpi as npi,\n\tentity_type_code as entity_type_code,\n\torganization_name as organization_name,\n\tlast_name as last_name,\n\tfirst_name as first_name,\n\tstate as state_abbreviation,\n\ttaxonomy_code as taxonomy_code\n  from {{ source('source', 'npi_small') }}", "database": "airflow", "schema": "public", "fqn": ["ge_tutorials", "staging", "stg_npi"], "unique_id": "model.ge_tutorials.stg_npi", "package_name": "ge_tutorials", "root_path": "/usr/local/airflow/dbt", "path": "staging/stg_npi.sql", "original_file_path": "models/staging/stg_npi.sql", "name": "stg_npi", "resource_type": "model", "alias": "stg_npi", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["source", "npi_small"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.ge_tutorials.source.npi_small"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/ge_tutorials/models/staging/stg_npi.sql", "compiled": true, "compiled_sql": "select \n\tnpi as npi,\n\tentity_type_code as entity_type_code,\n\torganization_name as organization_name,\n\tlast_name as last_name,\n\tfirst_name as first_name,\n\tstate as state_abbreviation,\n\ttaxonomy_code as taxonomy_code\n  from \"airflow\".\"public\".\"npi_small\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tnpi as npi,\n\tentity_type_code as entity_type_code,\n\torganization_name as organization_name,\n\tlast_name as last_name,\n\tfirst_name as first_name,\n\tstate as state_abbreviation,\n\ttaxonomy_code as taxonomy_code\n  from \"airflow\".\"public\".\"npi_small\""}, "error": null, "status": "CREATE VIEW", "execution_time": 0.31090569496154785, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-14T16:42:55.438432Z", "completed_at": "2020-08-14T16:42:55.494218Z"}, {"name": "execute", "started_at": "2020-08-14T16:42:55.498916Z", "completed_at": "2020-08-14T16:42:55.740938Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select \n\tname as state_name,\n\tabbreviation as state_abbreviation\n  from {{ source('source', 'state_abbreviations') }}", "database": "airflow", "schema": "public", "fqn": ["ge_tutorials", "staging", "stg_state_abbreviations"], "unique_id": "model.ge_tutorials.stg_state_abbreviations", "package_name": "ge_tutorials", "root_path": "/usr/local/airflow/dbt", "path": "staging/stg_state_abbreviations.sql", "original_file_path": "models/staging/stg_state_abbreviations.sql", "name": "stg_state_abbreviations", "resource_type": "model", "alias": "stg_state_abbreviations", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["source", "state_abbreviations"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.ge_tutorials.source.state_abbreviations"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/ge_tutorials/models/staging/stg_state_abbreviations.sql", "compiled": true, "compiled_sql": "select \n\tname as state_name,\n\tabbreviation as state_abbreviation\n  from \"airflow\".\"public\".\"state_abbreviations\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tname as state_name,\n\tabbreviation as state_abbreviation\n  from \"airflow\".\"public\".\"state_abbreviations\""}, "error": null, "status": "CREATE VIEW", "execution_time": 0.17213869094848633, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-14T16:42:55.764262Z", "completed_at": "2020-08-14T16:42:55.798264Z"}, {"name": "execute", "started_at": "2020-08-14T16:42:55.801214Z", "completed_at": "2020-08-14T16:42:55.928258Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select \n\tn.npi,\n\tn.entity_type_code,\n\tn.organization_name,\n\tn.last_name,\n\tn.first_name,\n\tn.taxonomy_code,\n\tn.state_abbreviation,\n\ts.state_name\nfrom {{ ref('stg_npi') }} n\n-- due to the nature of the data some state abbreviations are not valid\n-- which results in state names being null  - in this case,\n-- switch to inner join\ninner join {{ ref('stg_state_abbreviations') }} s\n\ton n.state_abbreviation = s.state_abbreviation", "database": "airflow", "schema": "public", "fqn": ["ge_tutorials", "npi_with_state"], "unique_id": "model.ge_tutorials.npi_with_state", "package_name": "ge_tutorials", "root_path": "/usr/local/airflow/dbt", "path": "npi_with_state.sql", "original_file_path": "models/npi_with_state.sql", "name": "npi_with_state", "resource_type": "model", "alias": "npi_with_state", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_npi"], ["stg_state_abbreviations"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.ge_tutorials.stg_npi", "model.ge_tutorials.stg_state_abbreviations"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/ge_tutorials/models/npi_with_state.sql", "compiled": true, "compiled_sql": "select \n\tn.npi,\n\tn.entity_type_code,\n\tn.organization_name,\n\tn.last_name,\n\tn.first_name,\n\tn.taxonomy_code,\n\tn.state_abbreviation,\n\ts.state_name\nfrom \"airflow\".\"public\".\"stg_npi\" n\n-- due to the nature of the data some state abbreviations are not valid\n-- which results in state names being null  - in this case,\n-- switch to inner join\ninner join \"airflow\".\"public\".\"stg_state_abbreviations\" s\n\ton n.state_abbreviation = s.state_abbreviation", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tn.npi,\n\tn.entity_type_code,\n\tn.organization_name,\n\tn.last_name,\n\tn.first_name,\n\tn.taxonomy_code,\n\tn.state_abbreviation,\n\ts.state_name\nfrom \"airflow\".\"public\".\"stg_npi\" n\n-- due to the nature of the data some state abbreviations are not valid\n-- which results in state names being null  - in this case,\n-- switch to inner join\ninner join \"airflow\".\"public\".\"stg_state_abbreviations\" s\n\ton n.state_abbreviation = s.state_abbreviation"}, "error": null, "status": "CREATE VIEW", "execution_time": 0.14318609237670898, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-14T16:42:55.946080Z", "completed_at": "2020-08-14T16:42:55.970683Z"}, {"name": "execute", "started_at": "2020-08-14T16:42:55.972541Z", "completed_at": "2020-08-14T16:42:56.082710Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select \n\tstate_name,\n\tcount(distinct npi) as count_providers\nfrom {{ ref('npi_with_state') }} n\ngroup by state_name", "database": "airflow", "schema": "public", "fqn": ["ge_tutorials", "count_providers_by_state"], "unique_id": "model.ge_tutorials.count_providers_by_state", "package_name": "ge_tutorials", "root_path": "/usr/local/airflow/dbt", "path": "count_providers_by_state.sql", "original_file_path": "models/count_providers_by_state.sql", "name": "count_providers_by_state", "resource_type": "model", "alias": "count_providers_by_state", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["npi_with_state"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.ge_tutorials.npi_with_state"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/ge_tutorials/models/count_providers_by_state.sql", "compiled": true, "compiled_sql": "select \n\tstate_name,\n\tcount(distinct npi) as count_providers\nfrom \"airflow\".\"public\".\"npi_with_state\" n\ngroup by state_name", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tstate_name,\n\tcount(distinct npi) as count_providers\nfrom \"airflow\".\"public\".\"npi_with_state\" n\ngroup by state_name"}, "error": null, "status": "CREATE VIEW", "execution_time": 0.11834931373596191, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-14T16:42:56.099840Z", "completed_at": "2020-08-14T16:42:56.124545Z"}, {"name": "execute", "started_at": "2020-08-14T16:42:56.125946Z", "completed_at": "2020-08-14T16:42:56.211914Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-08-14T16:42:56.301996Z", "elapsed_time": 1.2547955513000488}